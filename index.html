<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game After Lunch - Poin</title>
<style>
  body { font-family: Poppins, sans-serif; background: #f0f4f8; padding: 20px; }
  .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); max-width: 400px; margin: auto; }
  select, button { width: 100%; padding: 10px; margin-top: 10px; border-radius: 8px; border: 1px solid #ccc; }
  button { background: #007BFF; color: white; border: none; cursor: pointer; }
  button:hover { background: #0056b3; }
  .status { margin-top: 15px; font-weight: bold; text-align: center; }
</style>
</head>
<body>
<div class="card">
  <h2>üèÜ Tambah Poin Game</h2>
  <label>Pilih Poin:</label>
  <select id="poin">
    <option value="">-- Pilih Poin --</option>
    <option value="1">1 Poin</option>
    <option value="3">3 Poin</option>
    <option value="5">5 Poin</option>
    <option value="10">10 Poin</option>
  </select>

  <label>Pilih Game:</label>
  <select id="game">
    <option value="">-- Pilih Game --</option>
    <option value="uno">UNO</option>
    <option value="catur">Catur</option>
    <option value="jenga">Jenga</option>
    <option value="tepok_nyamuk">Tepok Nyamuk</option>
  </select>

  <button id="scanBtn">üì± Scan Kartu NFC</button>
  <div class="status" id="status">Menunggu aksi...</div>
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbwQ9UoTq6FHsAKYgVZMLLom8uEUy9vSaSbDPOBvx4MKUVHUUNnYP91saUpHmp5LGf97/exec";

document.getElementById("scanBtn").addEventListener("click", async () => {
  const poin = document.getElementById("poin").value;
  const game = document.getElementById("game").value;
  const statusDiv = document.getElementById("status");

  if (!poin || !game) {
    statusDiv.textContent = "‚ö†Ô∏è Pilih poin dan game terlebih dahulu!";
    return;
  }

  if (!("NDEFReader" in window)) {
    statusDiv.textContent = "‚ùå Browser ini tidak mendukung NFC.";
    return;
  }

  try {
    const ndef = new NDEFReader();
    await ndef.scan();
    statusDiv.textContent = "üì° Tempelkan kartu...";

    ndef.onreading = async event => {
      const uid = event.serialNumber.toUpperCase();
      statusDiv.textContent = `üîç Membaca kartu ${uid}...`;

      const formData = new URLSearchParams();
      formData.append("id_kartu", uid);
      formData.append("game", game);
      formData.append("poin", poin);

      const res = await fetch(scriptURL, {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: formData
      });

      const text = await res.text();
      statusDiv.textContent = text;
    };
  } catch (err) {
    statusDiv.textContent = "‚ùå Gagal memulai NFC: " + err.message;
  }
});
</script>
</body>
</html>
